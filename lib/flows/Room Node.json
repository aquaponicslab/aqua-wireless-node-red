[{"id":"817e85f1.7e8178","type":"mqtt-broker","broker":"localhost","port":"1883"},{"id":"c4dfb30f.3b205","type":"function","name":"Parse data","func":"var dataArray = msg.payload.split(' ');\ncontext.global.mode = \"receiving\";\ndataArray.pop(); // last element is newline\n\nvar tempMSB = dataArray.pop();\nvar tempLSB = dataArray.pop(); \nvar humidity = dataArray.pop();\nvar light = dataArray.pop();\nvar temp = 256* parseFloat(tempMSB)+ parseFloat(tempLSB);\n\nvar lightMsg  = {payload: light}; \nvar humidityMsg = {payload: humidity}; \nvar tempMsg = {payload: temp};\n\nreturn [lightMsg, humidityMsg, tempMsg];","outputs":"3","x":167,"y":131,"z":"6755e5e2.98aa1c","wires":[["8e4e62d4.71b1a"],["c4722df6.3b8dd"],["34df71a6.cb208e"]]},{"id":"8e4e62d4.71b1a","type":"function","name":"Scale Light","func":"/* \n\tRaw light reading needs scaling to lux\n*/\n\nvar light = msg.payload;\nif (light<50)\n  {\n  lightLevel=\"Very Dark!\";\n  }\nelse if (light<200)\n  {\n  lightLevel=\"Dark\";\n  }\n  else if (light<240)\n  {\n  lightLevel=\"Light\";\n  }\nelse\n  {\n  lightLevel=\"Very Light!\";\n  }\n\nreturn {payload: lightLevel};","outputs":1,"x":326,"y":96,"z":"6755e5e2.98aa1c","wires":[[]]},{"id":"c4722df6.3b8dd","type":"function","name":"Scale Humidity","func":"/* \n\tRaw humidity reading is twice real reading\n*/\n\nvar humid = msg.payload;\nhumid = humid / 2;\n\nreturn {payload: humid};","outputs":1,"x":340,"y":131,"z":"6755e5e2.98aa1c","wires":[["ec409c12.13bf6"]]},{"id":"34df71a6.cb208e","type":"function","name":"Scale Temperature","func":"/* \n\tRaw temperature reading is ten times too big\n*/\n\nvar temp = msg.payload;\ntemp = temp / 10;\n\n\nreturn {payload: temp};","outputs":1,"x":354,"y":166,"z":"6755e5e2.98aa1c","wires":[["d4c780aa.2b388"]]},{"id":"18451703.e7bae9","type":"function","name":"Report Battery","func":"if (msg.payload == '1') {\n\tmsg.payload = 'Battery Low!';\n} else {\n\tmsg.payload = 'Battery Normal';\n}\nreturn msg;","outputs":1,"x":340,"y":203,"z":"6755e5e2.98aa1c","wires":[["63e36057.9c1ca"]]},{"id":"63e36057.9c1ca","type":"mqtt out","name":"","topic":"Battery","broker":"817e85f1.7e8178","x":501,"y":203,"z":"6755e5e2.98aa1c","wires":[]},{"id":"d4c780aa.2b388","type":"mqtt out","name":"","topic":"Air Temperature","broker":"817e85f1.7e8178","x":525,"y":165,"z":"6755e5e2.98aa1c","wires":[]},{"id":"ec409c12.13bf6","type":"mqtt out","name":"","topic":"Humidity","broker":"817e85f1.7e8178","x":500,"y":130,"z":"6755e5e2.98aa1c","wires":[]}]